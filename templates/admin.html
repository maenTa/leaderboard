<!DOCTYPE html>
<html>
<head>
  <title>Race Control Panel</title>
  <script src="https://cdn.socket.io/4.6.1/socket.io.min.js"></script>
  <style>
    body { font-family: Segoe UI, sans-serif; background: #111; color: white; padding: 20px; }
    button {
      margin: 5px; padding: 10px 15px; border: none; border-radius: 8px;
      background: #444; color: white; cursor: pointer; transition: 0.2s;
    }
    button:hover { background: #666; }
    button.active { background: #e0a800; }
  </style>
</head>
<body>
  <h2>üèÅ Race Control Panel</h2>
  <button onclick="socket.emit('start_formation_lap')">Formation Lap</button>
  <button onclick="startLights()">Start Lights</button>
  <button onclick="confirmStart()">Confirm Start</button>
  <hr>

  <button onclick="sendFlag('yellow', 1)">Yellow S1</button>
  <button onclick="sendFlag('yellow', 2)">Yellow S2</button>
  <button onclick="sendFlag('yellow', 3)">Yellow S3</button>
  <button id="safetyBtn" onclick="toggleSafety()">Safety Car</button>
  <button onclick="sendFlag('red')">Red Flag</button>
  <button onclick="sendFlag('green')">Green Flag</button>

  <hr>
  <h3>Penalty</h3>
  <form onsubmit="sendPenalty(event)">
    Driver: <input type="text" id="driver"><br>
    Reason: <input type="text" id="reason"><br>
    Penalty: <input type="text" id="penalty"><br>
    <button type="submit">Send Penalty</button>
  </form>

  <script>
    const socket = io();
    let safetyActive = false;

    function startLights() {
      socket.emit('start_lights');
    }

    function confirmStart() {
      socket.emit('race_start');
    }

    function sendFlag(type, sector=null) {
      socket.emit('flag_event', { type, sector });
    }

    function toggleSafety() {
      safetyActive = !safetyActive;
      const btn = document.getElementById('safetyBtn');
      btn.classList.toggle('active', safetyActive);
      socket.emit('flag_event', { type: 'safety' });
    }

    function sendPenalty(e) {
      e.preventDefault();
      const data = {
        driver: document.getElementById('driver').value,
        reason: document.getElementById('reason').value,
        penalty: document.getElementById('penalty').value
      };
      socket.emit('penalty', data);
    }
  </script>
</body>
</html>
